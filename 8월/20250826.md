### :link: 2025-08-26
- [챗봇 연동을 위한 API 게이트웨이 구현](#1-챗봇-연동을-위한-api-게이트웨이-구현) 
- [동적 URL 설정](#2-동적-url-설정) 
 
&nbsp; 
### 1. 챗봇 연동을 위한 API 게이트웨이 구현
- Spring Boot 서비스 내부에 Python 기반 챗봇 서비스 호출 컨트롤러 추가
    - 기존에는 Python 내부에서 llm 서버를 직접 호출(8000 포트)하였으나, 이것은 기존에 의도하였던 서버 구현 계획과 상이하여 수정함

```java
// UserReservationChatController.java
@PostMapping("/reservation/chat")
public ResponseEntity<ApiResponse<UserReservationResponseDTO>> sendUserReservationMessage(
        @RequestBody @Valid UserReservationRequestDTO request,
        @AuthenticationPrincipal AuthDetails authDetails,
        HttpServletRequest httpServletRequest
){
    // HTTP 헤더에서 JWT 토큰 추출
    String token = ...; 

    // 토큰과 사용자 메시지를 ChatbotService로 전달
    UserReservationResponseDTO response = chatbotService.sendUserReservationChat(
            token,
            request.getQuery()
    );
    return ResponseEntity.ok(ApiResponse.success(response));
}
```

&emsp; 
&nbsp;
### 2. 동적 URL 설정
- 애플리케이션 실행 환경 감지 → "http://llm:8000" 또는 "http://localhost:8080" 반환

```python
# llm/app/services/user_reservation_service.py

def detect_url():
    """ Docker / local 환경 감지 -> url 반환 함수 """
    if "HOSTNAME" in os.environ:
        logging.info("🐳 도커 환경이 감지되었습니다. [llm:8000]")
        return "http://llm:8000"
    else:
        logging.info("💻 로컬 환경으로 추정됩니다. [localhost:8080]")
        return "http://localhost:8080"

BASE_API_URL = detect_url()
```

https://github.com/BOA-with-elephant/Header-backend/pull/255