### :link: 2025-08-22
- [YAML을 이용한 프롬프트 및 설정 관리](#1-yaml을-이용한-프롬프트-및-설정-관리)
- [다양한 대화 시나리오 처리](#2-다양한-대화-시나리오-처리)
 
&nbsp; 
### 1. YAML을 이용한 프롬프트 및 설정 관리

- 프롬프트를 직접 코드 내부에 포함한 하드 코딩 → 모든 프롬프트와 설정을 `user_reservation_bot.yaml` 파일로 분리

```yaml
# llm/app/core/settings/user_reservation_bot.yaml

name: "사용자 예약 도우미"

# OpenAI 설정
model: "gpt-4o-mini"
temperature: 0.7

# 응답 템플릿
response_templates:
  greeting: "안녕하세요! 저는 예약 관리를 도와드리는 챗봇입니다. ..."

# 기능별 프롬프트
prompts:
  re_reservation:
    system_prompt: |
      당신은 친절하고 똑똑한 뷰티샵 예약 담당자입니다.
      ...
```
 
&emsp; 
&nbsp;
### 2. 다양한 대화 시나리오 처리

- 인사, 예약 조회, 예약 취소, 의도를 알 수 없는 잡담 처리
- 프론트 처리 단순화를 위한 응답 형식 공통화 (data, actions 내부 type, label, payload)

**샵 추천**
```zsh
curl -X 'POST' \
  'http://localhost:8000/api/v1/reservation/chat' \
  -H 'accept: application/json' \
  -H 'Authorization: Bearer ...' \
  -H 'Content-Type: application/json' \
  -d '{
  "query": "염색 잘하는 미용실 추천해줘"
}'
```
```json
{
  "intent": "search_shops",
  "message": {
    "text": "'염색' 관련 샵 중 주변의 '모던헤어'을(를) 추천드려요."
  },
  "actions": [
    {
      "type": "SHOW_SHOP_DETAILS",
      "label": "샵 예약하러 가기",
      "payload": {
        "shopCode": 7
      }
    }
  ],
  "data": {
    "sub_intent": "new_recommendation",
    "recommendation": {
      "shopCode": 7,
      "shopName": "모던헤어",
      "menus": [
        {
          "shopCode": 7,
          "menuRevCount": 0,
          "menuName": "뿌리염색(3cm이하)",
          "menuCode": 92
        },
        {
          "shopCode": 7,
          "menuRevCount": 0,
          "menuName": "멋내기 뿌리염색",
          "menuCode": 93
        },
        ...
      ]
    }
  }
}
```
**잡담**
```zsh
curl -X 'POST' \
  'http://localhost:8000/api/v1/reservation/chat' \
  -H 'accept: application/json' \
  -H 'Authorization: Bearer ...' \
  -H 'Content-Type: application/json' \
  -d '{
  "query": "오늘 날씨 어때?"
}'
```
```json
{
  "intent": "unknown",
  "message": {
    "text": "죄송하지만, 날씨에 대한 정보는 제공할 수 없어요. 뷰티샵 예약이나 관련된 정보에 대해 도움이 필요하시면 말씀해 주세요!"
  },
  "actions": [],
  "data": null
}
```
&nbsp; &nbsp; &nbsp;&nbsp;→ 예약 관련 주제로 유도

https://github.com/BOA-with-elephant/Header-backend/pull/233